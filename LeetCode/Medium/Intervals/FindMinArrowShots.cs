namespace LeetCode.Medium.Intervals;

/// <summary>
/// 452. Minimum Number of Arrows to Burst Balloons
/// Условие: найти минимальное количество стрел, чтобы лопнуть все шары.
/// Стрела, выпущенная в позиции x, лопает все шары, которые пересекают x.
///
/// Подход (жадный алгоритм):
/// 1. Сортируем шары по правому концу (концу интервала).
/// 2. Первая стрела ставится в конец первого шара.
/// 3. Для каждого следующего шара:
///    - Если он начинается после последней стрелы → нужна новая стрела (ставим в его конец).
///    - Иначе текущая стрела уже лопнет этот шар.
///
/// Сложность:
/// - Время: O(n log n) — из-за сортировки
/// - Память: O(1) вне сортировки
///
/// Пример:
/// Input: points = [[10,16],[2,8],[1,6],[7,12]]
/// Output: 2
/// Объяснение:
/// - После сортировки: [[1,6],[2,8],[7,12],[10,16]]
/// - Стрела 1 в позиции 6 лопает шары [1,6] и [2,8]
/// - Стрела 2 в позиции 12 лопает шары [7,12] и [10,16]
/// </summary>
public class Solution2
{
    public int FindMinArrowShots(int[][] points)
    {
        if (points.Length == 0)
            return 0;
        
        // 0. Сортировка по правому концу (xend)
        Array.Sort(points, (a, b) => a[1].CompareTo(b[1]));
        
        var arrows = 1;                  // хотя бы одна стрела нужна
        var lastEnd = points[0][1];
        
        // 1. Проходим по всем остальным
        for (var i = 1; i < points.Length; i++)
        {
            var start = points[i][0];
            var end = points[i][1];
            
            // 2. Если шарик начинается после последней стрелы — нужна новая
            if (start > lastEnd)
            {
                arrows++;
                lastEnd = end;
            }
            // иначе — текущая стрела уже лопает этот шар
        }
        
        return arrows;
    }
}
